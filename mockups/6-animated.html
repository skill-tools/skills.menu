<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>skills.menu — Animated Mockup</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
<style>
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
:root{
  --bg:#09090b;--bg2:#18181b;--bg3:#27272a;--border:#27272a;--border2:#3f3f46;
  --text:#fafafa;--muted:#a1a1aa;--dim:#52525b;
  --cyan:#22d3ee;--cyan-muted:#164e63;
  --green:#4ade80;--yellow:#facc15;--purple:#a78bfa;--rose:#fb7185;
  --font-sans:'Inter',system-ui,sans-serif;
  --font-mono:'JetBrains Mono',monospace;
  --max-w:1100px;
  --header-h:60px;
}
html{font-size:16px;-webkit-font-smoothing:antialiased;scroll-behavior:smooth}
body{font-family:var(--font-sans);background:var(--bg);color:var(--text);line-height:1.6;overflow-x:hidden}
a{color:var(--cyan);text-decoration:none;transition:color .15s}
a:hover{color:var(--text)}
code{font-family:var(--font-mono);background:rgba(34,211,238,.08);padding:.15em .4em;border-radius:4px;font-size:.875em;border:1px solid rgba(34,211,238,.15);color:var(--cyan)}
pre code{background:none;padding:0;border-radius:0;border:none;font-size:inherit;color:inherit}
pre code span{background:none;padding:0;border:none;border-radius:0}
.container{max-width:var(--max-w);margin:0 auto;padding:0 1.5rem}

/* ─── HEADER ─── */
header{position:fixed;top:0;left:0;right:0;z-index:200;height:var(--header-h);background:rgba(9,9,11,.7);backdrop-filter:blur(16px);border-bottom:1px solid var(--border)}
header nav{display:flex;align-items:center;justify-content:space-between;max-width:var(--max-w);margin:0 auto;padding:0 1.5rem;height:100%}
.logo{display:flex;align-items:center;gap:.6rem;font-family:var(--font-mono);font-weight:600;font-size:1.05rem;color:var(--text)}
.logo:hover{color:var(--cyan)}
.logo svg{width:26px;height:26px;flex-shrink:0}
.nav-links{display:flex;gap:1.25rem;list-style:none;align-items:center}
.nav-links a{color:var(--muted);font-size:.85rem;font-weight:500}
.nav-links a:hover{color:var(--text)}
.nav-links .gh{display:flex;align-items:center;gap:.35rem}
.nav-links .gh svg{width:16px;height:16px;fill:currentColor}
.mobile-menu{display:none;background:none;border:none;color:var(--text);cursor:pointer;padding:4px}
.mobile-menu svg{width:24px;height:24px}

/* ─── WEBGL CANVAS ─── */
#skill-canvas{position:fixed;top:0;left:0;width:100%;height:100%;z-index:0;pointer-events:none}

/* ─── HERO ─── */
.hero{position:relative;z-index:10;padding:calc(var(--header-h) + 5rem) 0 4rem;text-align:center;min-height:100vh;display:flex;align-items:center}
.hero .container{width:100%}
.hero-badge{display:inline-flex;align-items:center;gap:.6rem;font-family:var(--font-mono);font-size:.78rem;margin-bottom:2rem}
.badge-dot{width:6px;height:6px;border-radius:50%;background:var(--green);box-shadow:0 0 8px var(--green);animation:pulse-dot 2s ease infinite}
@keyframes pulse-dot{0%,100%{opacity:1}50%{opacity:.4}}
.badge-text{color:var(--muted)}
.badge-text a{color:var(--cyan)}
.hero h1{font-size:clamp(2.25rem,5.5vw,4rem);font-weight:800;letter-spacing:-.04em;line-height:1.08;margin-bottom:1.25rem}
.hero h1 .hl{color:var(--cyan)}
.hero-sub{color:var(--muted);font-size:clamp(.95rem,2vw,1.1rem);max-width:500px;margin:0 auto 2.5rem;line-height:1.7}
.hero-actions{display:flex;gap:.75rem;justify-content:center;flex-wrap:wrap;margin-bottom:3.5rem}
.btn{display:inline-flex;align-items:center;gap:.4rem;padding:.65rem 1.3rem;border-radius:8px;font-size:.88rem;font-weight:600;border:1px solid transparent;transition:all .2s;white-space:nowrap}
.btn-primary{background:var(--cyan);color:var(--bg);border-color:var(--cyan)}
.btn-primary:hover{background:transparent;color:var(--cyan);box-shadow:0 0 20px rgba(34,211,238,.15)}
.btn-ghost{border-color:var(--border2);color:var(--text)}
.btn-ghost:hover{border-color:var(--muted);background:rgba(255,255,255,.03)}

/* ─── TERMINAL ─── */
.terminal-wrap{max-width:580px;margin:0 auto}
.terminal{background:rgba(9,9,11,.85);backdrop-filter:blur(8px);border:1px solid var(--border2);border-radius:10px;overflow:hidden;text-align:left}
.terminal-bar{display:flex;align-items:center;gap:6px;padding:10px 14px;border-bottom:1px solid var(--border)}
.tdot{width:9px;height:9px;border-radius:50%}
.tdot-r{background:var(--rose)}.tdot-y{background:var(--yellow)}.tdot-g{background:var(--green)}
.tfile{font-family:var(--font-mono);font-size:.68rem;color:var(--dim);margin-left:auto}
.terminal pre{margin:0;padding:1rem 1.1rem;font-size:.78rem;line-height:1.85;background:transparent;border:none;color:var(--text);overflow-x:auto}
.t-p{color:var(--cyan)}.t-c{color:var(--dim)}

/* ─── SECTIONS (shared) ─── */
.section{position:relative;z-index:10;padding:5rem 0}
.section-title{text-align:center;font-size:clamp(1.5rem,3vw,1.75rem);font-weight:700;margin-bottom:.5rem;letter-spacing:-.02em}
.section-sub{text-align:center;color:var(--muted);margin-bottom:3rem;font-size:clamp(.88rem,2vw,1rem)}

/* ─── STATS ─── */
.stats-row{display:grid;grid-template-columns:repeat(4,1fr);border:1px solid var(--border);border-radius:10px;overflow:hidden;background:rgba(24,24,27,.6);backdrop-filter:blur(8px)}
.stat{text-align:center;padding:1.75rem 1rem;border-right:1px solid var(--border)}
.stat:last-child{border-right:none}
.stat-val{font-family:var(--font-mono);font-size:1.75rem;font-weight:700;color:var(--cyan)}
.stat-label{font-size:.8rem;color:var(--muted);margin-top:.2rem}

/* ─── FEATURES ─── */
.feat-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:1rem}
.feat{background:rgba(24,24,27,.65);backdrop-filter:blur(6px);border:1px solid var(--border);border-radius:10px;padding:1.5rem;transition:all .25s}
.feat:hover{border-color:var(--border2);transform:translateY(-2px)}
.feat-num{font-family:var(--font-mono);font-size:.72rem;color:var(--cyan);margin-bottom:.6rem;font-weight:600}
.feat h3{font-family:var(--font-mono);font-size:.95rem;margin-bottom:.4rem;font-weight:600}
.feat p{font-size:.82rem;color:var(--muted);line-height:1.55}
.feat-tags{display:flex;gap:.35rem;flex-wrap:wrap;margin-top:.75rem}
.ftag{font-family:var(--font-mono);font-size:.62rem;padding:.15em .45em;border-radius:3px;background:rgba(34,211,238,.06);color:var(--dim);border:1px solid rgba(34,211,238,.1)}

/* ─── SKILL PREVIEW ─── */
.preview-grid{display:grid;grid-template-columns:1fr 260px;gap:1.5rem;align-items:start}
.annos{display:flex;flex-direction:column;gap:.75rem}
.anno{background:rgba(24,24,27,.6);border:1px solid var(--border);border-radius:8px;padding:.85rem 1rem}
.anno-lbl{font-family:var(--font-mono);font-size:.67rem;color:var(--cyan);text-transform:uppercase;letter-spacing:.06em;margin-bottom:.25rem;font-weight:600}
.anno p{font-size:.78rem;color:var(--muted);line-height:1.45}
.hl-d{color:var(--dim)}.hl-k{color:var(--cyan)}.hl-v{color:var(--text)}.hl-s{color:var(--green)}.hl-h1{color:var(--text);font-weight:600}.hl-h2{color:var(--muted)}.hl-c{color:var(--yellow)}

/* ─── CTA ─── */
.cta-box{background:rgba(24,24,27,.65);backdrop-filter:blur(8px);border:1px solid var(--border);border-radius:12px;padding:clamp(2rem,4vw,3.5rem);text-align:center}
.cta-box h2{margin-bottom:.75rem;font-size:1.4rem}
.cta-box p{color:var(--muted);max-width:480px;margin:0 auto 2rem;line-height:1.7;font-size:.92rem}
.cta-links{display:flex;gap:.75rem;justify-content:center;flex-wrap:wrap}

/* ─── FOOTER ─── */
footer{position:relative;z-index:10;border-top:1px solid var(--border);padding:2rem 0;margin-top:2rem}
.footer-inner{display:flex;justify-content:space-between;align-items:center;font-size:.78rem;color:var(--dim);flex-wrap:wrap;gap:.75rem}
.foot-links{display:flex;gap:1.25rem;list-style:none}
.foot-links a{color:var(--muted);font-size:.78rem}

/* ─── MOBILE ─── */
@media(max-width:768px){
  .nav-links{display:none}
  .mobile-menu{display:block}
  .hero{padding:calc(var(--header-h) + 3rem) 0 2rem;min-height:auto}
  .stats-row{grid-template-columns:repeat(2,1fr)}
  .stat:nth-child(2){border-right:none}
  .stat:nth-child(1),.stat:nth-child(2){border-bottom:1px solid var(--border)}
  .feat-grid{grid-template-columns:1fr}
  .preview-grid{grid-template-columns:1fr}
  .hero-actions{flex-direction:column;align-items:center}
  .cta-links{flex-direction:column;align-items:center}
  .footer-inner{flex-direction:column;text-align:center}
}
@media(max-width:400px){
  .hero h1{font-size:2rem}
  .section{padding:3rem 0}
}
</style>
</head>
<body>

<!-- ─── WEBGL BACKGROUND ─── -->
<canvas id="skill-canvas"></canvas>

<header>
<nav>
  <a href="#" class="logo">
    <svg viewBox="0 0 26 26" fill="none" xmlns="http://www.w3.org/2000/svg">
      <rect width="26" height="26" rx="6" fill="#22d3ee"/>
      <path d="M7 9.5l3.5 3.5L7 16.5" stroke="#09090b" stroke-width="2.2" stroke-linecap="round" stroke-linejoin="round"/>
      <line x1="13" y1="16.5" x2="19" y2="16.5" stroke="#09090b" stroke-width="2.2" stroke-linecap="round"/>
    </svg>
    skills.menu
  </a>
  <ul class="nav-links">
    <li><a href="#">Docs</a></li>
    <li><a href="#">Spec</a></li>
    <li><a href="#" class="gh"><svg viewBox="0 0 24 24"><path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/></svg>GitHub</a></li>
  </ul>
  <button class="mobile-menu" aria-label="Menu">
    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 12h18M3 6h18M3 18h18"/></svg>
  </button>
</nav>
</header>

<!-- ─── HERO ─── -->
<section class="hero">
<div class="container">
  <div class="hero-badge">
    <span class="badge-dot"></span>
    <span class="badge-text">v0.1.0 &mdash; following <a href="#">agentskills.io</a></span>
  </div>
  <h1><span class="hl">Tooling</span> for<br>Agent Skills</h1>
  <p class="hero-sub">Validate, lint, score, route, and generate <code>SKILL.md</code> files. Open&#8209;source. Zero&nbsp;LLM&nbsp;dependencies.</p>
  <div class="hero-actions">
    <a href="#" class="btn btn-primary">View on GitHub</a>
    <a href="#" class="btn btn-ghost">Read the Docs</a>
  </div>
  <div class="terminal-wrap">
    <div class="terminal">
      <div class="terminal-bar">
        <span class="tdot tdot-r"></span><span class="tdot tdot-y"></span><span class="tdot tdot-g"></span>
        <span class="tfile">terminal</span>
      </div>
      <pre><code><span class="t-p">$</span> npm install @skillkit/core       <span class="t-c"># parser &amp; types</span>
<span class="t-p">$</span> npm install -g skillkit           <span class="t-c"># CLI validator</span>
<span class="t-p">$</span> npm install skillrouter           <span class="t-c"># semantic routing</span>
<span class="t-p">$</span> npm install -g skillgen           <span class="t-c"># OpenAPI generator</span></code></pre>
    </div>
  </div>
</div>
</section>

<!-- ─── STATS ─── -->
<section class="section">
<div class="container">
  <div class="stats-row">
    <div class="stat"><div class="stat-val">4</div><div class="stat-label">packages</div></div>
    <div class="stat"><div class="stat-val">114</div><div class="stat-label">tests passing</div></div>
    <div class="stat"><div class="stat-val">0</div><div class="stat-label">LLM deps</div></div>
    <div class="stat"><div class="stat-val">100%</div><div class="stat-label">TypeScript</div></div>
  </div>
</div>
</section>

<!-- ─── FEATURES ─── -->
<section class="section">
<div class="container">
  <h2 class="section-title">Four tools, one ecosystem</h2>
  <p class="section-sub">Everything you need to build, validate, and deploy agent skills at scale.</p>
  <div class="feat-grid">
    <div class="feat"><div class="feat-num">01</div><h3>@skillkit/core</h3><p>Parse SKILL.md files, extract metadata, count tokens, resolve file references. The foundation.</p><div class="feat-tags"><span class="ftag">parser</span><span class="ftag">types</span><span class="ftag">tokenizer</span></div></div>
    <div class="feat"><div class="feat-num">02</div><h3>skillkit</h3><p>CLI for validating, linting, and quality-scoring skills. 8 lint rules, 5 scoring dimensions.</p><div class="feat-tags"><span class="ftag">CLI</span><span class="ftag">validate</span><span class="ftag">lint</span><span class="ftag">score</span></div></div>
    <div class="feat"><div class="feat-num">03</div><h3>skillrouter</h3><p>Semantic skill selection using TF-IDF embeddings and cosine similarity. Zero external deps.</p><div class="feat-tags"><span class="ftag">embeddings</span><span class="ftag">routing</span><span class="ftag">search</span></div></div>
    <div class="feat"><div class="feat-num">04</div><h3>skillgen</h3><p>Generate SKILL.md from OpenAPI 3.x specs or plain text. Unified or per-endpoint modes.</p><div class="feat-tags"><span class="ftag">OpenAPI</span><span class="ftag">generator</span><span class="ftag">CLI</span></div></div>
  </div>
</div>
</section>

<!-- ─── SKILL PREVIEW ─── -->
<section class="section">
<div class="container">
  <h2 class="section-title">What's a SKILL.md?</h2>
  <p class="section-sub">A portable format for AI agent instructions. YAML frontmatter + Markdown body.</p>
  <div class="preview-grid">
    <div class="terminal">
      <div class="terminal-bar">
        <span class="tdot tdot-r"></span><span class="tdot tdot-y"></span><span class="tdot tdot-g"></span>
        <span class="tfile">deploy-vercel/SKILL.md</span>
      </div>
      <pre><code><span class="hl-d">---</span>
<span class="hl-k">name:</span> <span class="hl-v">deploy-vercel</span>
<span class="hl-k">description:</span> <span class="hl-s">Deploy web apps to Vercel.</span>
  <span class="hl-s">Use when pushing to production.</span>
<span class="hl-k">version:</span> <span class="hl-v">1.0.0</span>
<span class="hl-k">license:</span> <span class="hl-v">Apache-2.0</span>
<span class="hl-d">---</span>

<span class="hl-h1"># Deploy to Vercel</span>

<span class="hl-h2">## Prerequisites</span>
- Vercel CLI (<span class="hl-c">`npm i -g vercel`</span>)
- Project linked (<span class="hl-c">`vercel link`</span>)

<span class="hl-h2">## Steps</span>
1. Run <span class="hl-c">`vercel --prod`</span>
2. Verify deployment URL
3. Report live URL to user

<span class="hl-h2">## Error Handling</span>
If deploy fails, check <span class="hl-c">`vercel logs`</span>.</code></pre>
    </div>
    <div class="annos">
      <div class="anno"><div class="anno-lbl">frontmatter</div><p>YAML metadata: name, description, version, license. Name must match directory.</p></div>
      <div class="anno"><div class="anno-lbl">description</div><p>Required. Tells agents <em>when</em> to use this skill. Powers semantic routing.</p></div>
      <div class="anno"><div class="anno-lbl">body</div><p>Markdown instructions. Keep under 5,000 tokens for optimal context usage.</p></div>
      <div class="anno"><div class="anno-lbl">progressive disclosure</div><p>Reference external files in scripts/, references/, assets/ to stay lean.</p></div>
    </div>
  </div>
</div>
</section>

<!-- ─── CTA ─── -->
<section class="section">
<div class="container">
  <div class="cta-box">
    <h2>Built on an open standard</h2>
    <p>Implements the <a href="#">Agent Skills specification</a> &mdash; a portable, vendor-neutral format for packaging AI agent capabilities.</p>
    <div class="cta-links">
      <a href="#" class="btn btn-primary">Read the Spec</a>
      <a href="#" class="btn btn-ghost">Reference Library</a>
    </div>
  </div>
</div>
</section>

<footer>
<div class="container footer-inner">
  <span>Built for the <a href="#">Agent Skills</a> open standard</span>
  <ul class="foot-links"><li><a href="#">Specification</a></li><li><a href="#">Source</a></li><li><a href="#">Reference</a></li></ul>
</div>
</footer>

<!-- ─── WEBGL SKILL NETWORK ANIMATION ─── -->
<script>
(function() {
  const canvas = document.getElementById('skill-canvas');
  const gl = canvas.getContext('webgl', { alpha: true, antialias: true, premultipliedAlpha: false });
  if (!gl) return;

  // ─── Shader sources ───
  const nodeVS = `
    attribute vec2 aPos;
    attribute float aSize;
    attribute vec3 aColor;
    attribute float aAlpha;
    varying vec3 vColor;
    varying float vAlpha;
    void main() {
      gl_Position = vec4(aPos, 0.0, 1.0);
      gl_PointSize = aSize;
      vColor = aColor;
      vAlpha = aAlpha;
    }
  `;
  const nodeFS = `
    precision mediump float;
    varying vec3 vColor;
    varying float vAlpha;
    void main() {
      float d = length(gl_PointCoord - vec2(0.5));
      if (d > 0.5) discard;
      float glow = smoothstep(0.5, 0.1, d);
      float core = smoothstep(0.25, 0.0, d);
      vec3 c = mix(vColor * 0.4, vColor, core);
      float a = glow * vAlpha;
      gl_FragColor = vec4(c, a);
    }
  `;
  const lineVS = `
    attribute vec2 aPos;
    attribute float aAlpha;
    varying float vAlpha;
    void main() {
      gl_Position = vec4(aPos, 0.0, 1.0);
      vAlpha = aAlpha;
    }
  `;
  const lineFS = `
    precision mediump float;
    varying float vAlpha;
    uniform vec3 uColor;
    void main() {
      gl_FragColor = vec4(uColor, vAlpha * 0.2);
    }
  `;

  function compile(src, type) {
    const s = gl.createShader(type);
    gl.shaderSource(s, src);
    gl.compileShader(s);
    return s;
  }
  function link(vs, fs) {
    const p = gl.createProgram();
    gl.attachShader(p, compile(vs, gl.VERTEX_SHADER));
    gl.attachShader(p, compile(fs, gl.FRAGMENT_SHADER));
    gl.linkProgram(p);
    return p;
  }

  const nodeProg = link(nodeVS, nodeFS);
  const lineProg = link(lineVS, lineFS);

  const nA = {
    aPos: gl.getAttribLocation(nodeProg, 'aPos'),
    aSize: gl.getAttribLocation(nodeProg, 'aSize'),
    aColor: gl.getAttribLocation(nodeProg, 'aColor'),
    aAlpha: gl.getAttribLocation(nodeProg, 'aAlpha'),
  };
  const lA = {
    aPos: gl.getAttribLocation(lineProg, 'aPos'),
    aAlpha: gl.getAttribLocation(lineProg, 'aAlpha'),
    uColor: gl.getUniformLocation(lineProg, 'uColor'),
  };

  // ─── Skill node data ───
  const SKILL_LABELS = [
    'deploy','lint','test','score','parse','route','generate','validate',
    'build','format','migrate','auth','cache','monitor','debug','index',
    'search','embed','resolve','check','serve','compile','bundle','scan'
  ];

  const PALETTE = [
    [0.133, 0.827, 0.933],  // cyan
    [0.290, 0.855, 0.502],  // green
    [0.655, 0.545, 0.988],  // purple
    [0.980, 0.745, 0.098],  // yellow
    [0.984, 0.475, 0.471],  // rose
    [0.133, 0.827, 0.933],  // cyan again
  ];

  const NODE_COUNT = 50;
  const CONNECT_DIST = 0.28;
  const isMobile = window.innerWidth < 768;

  const nodes = [];
  for (let i = 0; i < NODE_COUNT; i++) {
    const col = PALETTE[Math.floor(Math.random() * PALETTE.length)];
    const isLabeled = i < SKILL_LABELS.length;
    nodes.push({
      x: (Math.random() * 2 - 1) * 0.95,
      y: (Math.random() * 2 - 1) * 0.95,
      vx: (Math.random() - 0.5) * 0.0008,
      vy: (Math.random() - 0.5) * 0.0008,
      size: isLabeled ? (isMobile ? 4 : 6) : (isMobile ? 2 : 3),
      color: col,
      alpha: isLabeled ? 0.9 : 0.35,
      label: isLabeled ? SKILL_LABELS[i] : null,
      // Pulse state
      pulsePhase: Math.random() * Math.PI * 2,
      pulseSpeed: 0.3 + Math.random() * 0.5,
    });
  }

  // Routing "packets" that travel along edges
  const packets = [];
  const MAX_PACKETS = isMobile ? 8 : 20;

  function spawnPacket(n1, n2) {
    if (packets.length >= MAX_PACKETS) return;
    packets.push({
      from: n1, to: n2,
      t: 0,
      speed: 0.005 + Math.random() * 0.01,
      color: n1.color,
    });
  }

  // ─── Buffers ───
  const nodePosBuf = gl.createBuffer();
  const nodeSizeBuf = gl.createBuffer();
  const nodeColorBuf = gl.createBuffer();
  const nodeAlphaBuf = gl.createBuffer();
  const linePosBuf = gl.createBuffer();
  const lineAlphaBuf = gl.createBuffer();

  // For packets (rendered as points)
  const pktPosBuf = gl.createBuffer();
  const pktSizeBuf = gl.createBuffer();
  const pktColorBuf = gl.createBuffer();
  const pktAlphaBuf = gl.createBuffer();

  function resize() {
    const dpr = Math.min(window.devicePixelRatio || 1, 2);
    canvas.width = window.innerWidth * dpr;
    canvas.height = window.innerHeight * dpr;
    canvas.style.width = window.innerWidth + 'px';
    canvas.style.height = window.innerHeight + 'px';
    gl.viewport(0, 0, canvas.width, canvas.height);
  }
  resize();
  window.addEventListener('resize', resize);

  let mouseX = 0, mouseY = 0;
  window.addEventListener('mousemove', (e) => {
    mouseX = (e.clientX / window.innerWidth) * 2 - 1;
    mouseY = -((e.clientY / window.innerHeight) * 2 - 1);
  });

  let time = 0;
  let spawnTimer = 0;

  function frame() {
    time += 0.016;
    spawnTimer += 0.016;

    gl.clearColor(0, 0, 0, 0);
    gl.clear(gl.COLOR_BUFFER_BIT);
    gl.enable(gl.BLEND);
    gl.blendFunc(gl.SRC_ALPHA, gl.ONE);

    const aspect = canvas.width / canvas.height;

    // ─── Update nodes ───
    for (const n of nodes) {
      n.x += n.vx;
      n.y += n.vy;

      // Subtle mouse repulsion
      const dx = n.x - mouseX;
      const dy = n.y - mouseY;
      const md = Math.sqrt(dx * dx + dy * dy);
      if (md < 0.3 && md > 0.001) {
        const force = 0.00003 / (md * md);
        n.vx += dx / md * force;
        n.vy += dy / md * force;
      }

      // Drift toward center gently
      n.vx -= n.x * 0.00002;
      n.vy -= n.y * 0.00002;

      // Speed limit
      const speed = Math.sqrt(n.vx * n.vx + n.vy * n.vy);
      const maxSpeed = 0.001;
      if (speed > maxSpeed) {
        n.vx = (n.vx / speed) * maxSpeed;
        n.vy = (n.vy / speed) * maxSpeed;
      }

      // Bounce
      if (n.x < -1 || n.x > 1) n.vx *= -1;
      if (n.y < -1 || n.y > 1) n.vy *= -1;
      n.x = Math.max(-1, Math.min(1, n.x));
      n.y = Math.max(-1, Math.min(1, n.y));
    }

    // ─── Find connections ───
    const linePos = [];
    const lineAlpha = [];
    const connections = [];
    for (let i = 0; i < nodes.length; i++) {
      for (let j = i + 1; j < nodes.length; j++) {
        const dx = (nodes[i].x - nodes[j].x) * aspect;
        const dy = nodes[i].y - nodes[j].y;
        const d = Math.sqrt(dx * dx + dy * dy);
        if (d < CONNECT_DIST) {
          const a = 1.0 - d / CONNECT_DIST;
          linePos.push(nodes[i].x, nodes[i].y, nodes[j].x, nodes[j].y);
          lineAlpha.push(a, a);
          connections.push([i, j, a]);
        }
      }
    }

    // Spawn routing packets along connections
    if (spawnTimer > 0.3 && connections.length > 0) {
      spawnTimer = 0;
      const c = connections[Math.floor(Math.random() * connections.length)];
      if (c[2] > 0.3) {
        const dir = Math.random() > 0.5;
        spawnPacket(nodes[dir ? c[0] : c[1]], nodes[dir ? c[1] : c[0]]);
      }
    }

    // ─── Draw lines ───
    if (linePos.length > 0) {
      gl.useProgram(lineProg);
      gl.uniform3f(lA.uColor, 0.133, 0.827, 0.933);

      gl.bindBuffer(gl.ARRAY_BUFFER, linePosBuf);
      gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(linePos), gl.DYNAMIC_DRAW);
      gl.enableVertexAttribArray(lA.aPos);
      gl.vertexAttribPointer(lA.aPos, 2, gl.FLOAT, false, 0, 0);

      gl.bindBuffer(gl.ARRAY_BUFFER, lineAlphaBuf);
      gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(lineAlpha), gl.DYNAMIC_DRAW);
      gl.enableVertexAttribArray(lA.aAlpha);
      gl.vertexAttribPointer(lA.aAlpha, 1, gl.FLOAT, false, 0, 0);

      gl.drawArrays(gl.LINES, 0, lineAlpha.length);
    }

    // ─── Draw nodes ───
    const nPos = [], nSize = [], nColor = [], nAlp = [];
    for (const n of nodes) {
      const pulse = Math.sin(time * n.pulseSpeed + n.pulsePhase) * 0.15 + 0.85;
      nPos.push(n.x, n.y);
      nSize.push(n.size * pulse * (canvas.width / 1000));
      nColor.push(n.color[0], n.color[1], n.color[2]);
      nAlp.push(n.alpha * pulse);
    }

    gl.useProgram(nodeProg);

    gl.bindBuffer(gl.ARRAY_BUFFER, nodePosBuf);
    gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(nPos), gl.DYNAMIC_DRAW);
    gl.enableVertexAttribArray(nA.aPos);
    gl.vertexAttribPointer(nA.aPos, 2, gl.FLOAT, false, 0, 0);

    gl.bindBuffer(gl.ARRAY_BUFFER, nodeSizeBuf);
    gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(nSize), gl.DYNAMIC_DRAW);
    gl.enableVertexAttribArray(nA.aSize);
    gl.vertexAttribPointer(nA.aSize, 1, gl.FLOAT, false, 0, 0);

    gl.bindBuffer(gl.ARRAY_BUFFER, nodeColorBuf);
    gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(nColor), gl.DYNAMIC_DRAW);
    gl.enableVertexAttribArray(nA.aColor);
    gl.vertexAttribPointer(nA.aColor, 3, gl.FLOAT, false, 0, 0);

    gl.bindBuffer(gl.ARRAY_BUFFER, nodeAlphaBuf);
    gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(nAlp), gl.DYNAMIC_DRAW);
    gl.enableVertexAttribArray(nA.aAlpha);
    gl.vertexAttribPointer(nA.aAlpha, 1, gl.FLOAT, false, 0, 0);

    gl.drawArrays(gl.POINTS, 0, nodes.length);

    // ─── Update and draw packets ───
    for (let i = packets.length - 1; i >= 0; i--) {
      const p = packets[i];
      p.t += p.speed;
      if (p.t >= 1) { packets.splice(i, 1); continue; }
    }

    if (packets.length > 0) {
      const pPos = [], pSize = [], pCol = [], pAlp = [];
      for (const p of packets) {
        const x = p.from.x + (p.to.x - p.from.x) * p.t;
        const y = p.from.y + (p.to.y - p.from.y) * p.t;
        const fade = Math.sin(p.t * Math.PI);
        pPos.push(x, y);
        pSize.push((isMobile ? 3 : 5) * (canvas.width / 1000));
        pCol.push(p.color[0], p.color[1], p.color[2]);
        pAlp.push(fade * 0.9);
      }

      gl.useProgram(nodeProg);

      gl.bindBuffer(gl.ARRAY_BUFFER, pktPosBuf);
      gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(pPos), gl.DYNAMIC_DRAW);
      gl.enableVertexAttribArray(nA.aPos);
      gl.vertexAttribPointer(nA.aPos, 2, gl.FLOAT, false, 0, 0);

      gl.bindBuffer(gl.ARRAY_BUFFER, pktSizeBuf);
      gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(pSize), gl.DYNAMIC_DRAW);
      gl.enableVertexAttribArray(nA.aSize);
      gl.vertexAttribPointer(nA.aSize, 1, gl.FLOAT, false, 0, 0);

      gl.bindBuffer(gl.ARRAY_BUFFER, pktColorBuf);
      gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(pCol), gl.DYNAMIC_DRAW);
      gl.enableVertexAttribArray(nA.aColor);
      gl.vertexAttribPointer(nA.aColor, 3, gl.FLOAT, false, 0, 0);

      gl.bindBuffer(gl.ARRAY_BUFFER, pktAlphaBuf);
      gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(pAlp), gl.DYNAMIC_DRAW);
      gl.enableVertexAttribArray(nA.aAlpha);
      gl.vertexAttribPointer(nA.aAlpha, 1, gl.FLOAT, false, 0, 0);

      gl.drawArrays(gl.POINTS, 0, packets.length);
    }

    requestAnimationFrame(frame);
  }

  requestAnimationFrame(frame);
})();
</script>

</body>
</html>
